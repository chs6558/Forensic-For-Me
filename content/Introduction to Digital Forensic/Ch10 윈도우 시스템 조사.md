---
title: "10장 윈도우 시스템 조사"
metaTitle: ""
metaDescription: ""
---

대부분 개인용 컴퓨터에는 Windows OS가 설치되어 있다. 이에 따라 포렌식 조사를 할 때 Window OS를 대상으로 진행하는 경우가 많다. 

## 활성 시스템 조사

윈도우 시스템의 경우 각 버전 별로 시스템 도구 및 API와 비휘발성 데이터가 저장되는 위치 또는 형태가 다를 수 있으므로 이러한 특성을 고려하여 진행하여야 한다. 

1. **시스템 정보**

   ​	**1) 시스템 시간 정보**

   **시스템 정보를 수집할 떄, 가장 먼저 시스템 시간이 조사 시간과 일치하는지를 확인해야 한다.**  이는 시스템에 저장되어 있는 시간 정보를 정확히 파악하는데 도움을 주며, 시스템에서 수행한 작업들의 타임라인을 밝히는데 이용한다.

   휴대 전화 시간과 같은 정확한 시간과 시스템의 시간 사이의 오차를 파악하고, 시스템 시간이 다를 경우 시간 오차를 고려하면서 조사를 진행한다. 

   Window Command 

   - date /t 
   - time /t

   

   ​	**2) 사용자 계정 정보**

   포렌식 조사에서 사용자를 밝히는 것이 매우 중요하다. 이러한 관점에서 현재 시스템에 등록된 사용자의 계정 정보를 파악할 필요가 있다. 특히 프로세스나 파일의 소유자 정보와 연관시켜서 조사를 진행할 수 있고, 인터넷 익스플로러 사용 로그인 index.dat 나 휴지통 파일도 계정별로 생성되기 때문에 해당 시스템에 등록된 계정 정보를 파악할 필요가 있다. 

   Window Command

   - net user
   - wmic useraccount get name

   

   ​	**3) Process Information**

   Process는 메모리에 적재되어 실행 중인 프로그램을 의미하며, 현재 시스템의 동작 상황을 파악할 수 있는 중요한 정보이다. 특히 악성 코드의 실행 과정을 규명하는데 유용하다. 

   실행중인 프로세스를 조사하기 위해서는 sysinternal에서 제작한 Process Explorer를 이용한다. 프로세스 간의 호출 관계를 파악하여 악성 코드를 실행한 플로세스를 탐지할 수 있으며, 프로세스의 CPU 사용량을 조사할 수 있다. **특히 시스템 프로세스의 경우 정상 경로가 아닌 특이한 폴더 경로에서 실행되고 있을 경우, 시스템 프로세스를 가장한 악성 코드가 실행되고 있을 가능성이 존재한다.** 

   악성 코드는 시스템의 중요 파일에 접근하여 내용을 변경하는데 **윈도우 시스템은 프로세스가 접근하는 파일들에 대한 목록을 Handle로 관리한다.** 따라서 프로세스가 접근하고 있는 자원에 대해서 조사해야 한다. 

   만약 악성 코드가 ACPACK이나 UPX와 같은 알고리즘을 통해 패킹되어 있지 않다면, 내부의 문자열에 공격자의 IP와 같은 정보와 특정 포트를 여는 것과 같이 악성 행위를 유추할 수 있는 문자열을 확인할 수 있다. 악성 코드가 패킹되어 있다면 해당 알고리즘에 적합한 Unpacker를 사용해서 패킹을 해제하고 분석을 수행해야 한다. **일반적으로 악성 코드는 역공학을 어렵게 하기 위해서 패킹하기 때문에 패킹된 프로그램은 추가적인 분석을 통해서 악성 여부를 판단해야 한다.**

   실행된느 프로그램의 유해성은 장시간에 걸친 행위 분석을 통해 파악할 수 있다. 이러한 문제를 해결하기 위해 프로그램을 배포할 떄 전자 서명을 하여 배포하는 Code Signing 기법이 있으며, 윈도우 시스템이 프로그램을 실행할 때 이를 검증하게 할 수 있다. 따라서 특정 프로세스의 Code Sign을 확인하면 추가적인 분석을 수행할 것인지 빠르게 판단할 수 있다. 

   프로세스 조사 과정 중에서 발견된 프로세스가 어떤 역할을 수행하는지 확인하여야 한다. 프로세스 이름과 설명 및 악성 여부를 판별할 수 있도록 정보를 제공하는 웹 사이트가 있다. (http://www.processlibrary.com) 이 사이트에서 제공하는 정보를 통해서 특정 프로세스를 추가로 분석할 것인지를 결정할 수 있다. 

   윈도우 시스템은 XP 이상 버전에서 로그 파일의 일종인 Prefetch파일을 생성한다. 프리패치 파일은 시스템 부팅 및 응용 프로그램의 실행시간을 단축하기 위해 여러가지 정보가 저장되어 있다. 이 파일에는 실행 파일의 이름, 등 디지털 포렌식 관점에서 중요한 정보들이 포함되어 있다. 따라서 Windows prefetch 파일을 조사하여 악성 프로그램의 실행 여부를 판단할 수 있다. 

   c:\WINDOWS\Prefetch 폴더에 저장되어 있다. 
   
2. **네트워크 정보**

   ​	**1) 네트워크 장치정보**

   네트워크 장치는 주로 사용되는 Ethernet Card, IEEE 802.11x 를 지원하는 무선 접속 단말기 등을 의미한다. **네트워크 장치는 해당 시스템과 외부 자원을 연결하는 통로이므로 외부 침입이나 악성 코드 행위 분석을 할 때에 반드시 조사해야하는 경로이다.** 

   해당 시스템에 연결된 모든 네트워크 장치에 할당된 IP 정보, MAC 주소, 하드 웨어 ID 등을 수집하여 어떤 주소로 통신했는지 파악할 필요가 있다.

   Window Command 

   - ipconfig

   ​	**2) 네트워크 테이블**

   **네트워크에 접속하기 위해서는 주변에 있는 네트워크 장치 정보를 가지고 있어야 하는데 이를 관리하는 정보를 네트워크 테이블**이라고 한다. 

   - Routing Table 
   - Address Resolution Protocol

   라우팅 테이블은 특정 패킷이 네트워크를 통해서 다른 시스템으로 전송될 때 사용하기 위한 경로 정보를 저장한 것이다. **라우팅 테이블은 IP 정보를 저장한다.**

   **ARP 테이블은 주변의 시스템에 장착된 네트워크 장치에 부여된 Media Access Control 주소를 저장하고. (MAC Address)**
   
   Window Command
   
   - ARP 
   
   많이 알려진 **spoofing 공격은 대상 시스템의 ARP 테이블을 변조하여 게이트웨이의 MAC 주소와 공격자의 MAC 주소를 동일하게 설정함으로써 시작된다.**  그러면 대상 시스템에서 전송되는 모든 패킷은 공격자의 시스템으로 전송되며, 공격자는 대상 시스템의 모든 패킷을 모니터링할 수 있게 된다. 따라서 해당 시스템의 네트워크 테이블을 조사하여 비인가된 주소를 가지고 있는 항목이 없는지를 확인해야 한다. **특히 특정 MAC 주소가 서로 다른 IP에서 나타날 경우 ARP Spoofing을 의심할 수 있다.** 
   
   ​	**3) TCP/UDP 연결 상태 정보**
   
   프로세스가 외부와 통신하기 위해서는 네트워크 포트를 할당해야 한다. 악성 코드 역시 동일하게 외부와 통신하기 때문에 침해 사고를 조사할 때는 현재 네트워크 연결 상태를 확인하고 사용 정보를 바탕으로 인가되지 않은 접속을 판별해야 한다 
   
   분석 방법은 현재 시스템에 외부와 연결된 포트를 확인하고, 해당 포트를 사용하는 프로세스를 판별하는 것이다. 호스트로 들어온 연결 정보, 호스트에서 나가는 연결 정보를 통해서 침입의 흔적을 발견할 수 있다. 
   
   Windows Command
   
   - Netstat /no
   
   TCP와 UDP를 모두 조사해야 하며, UDP는 비연결 지향상 프로토콜이기 때문에 연결된 외부 IP 정보는 따로 존재하지 않지만 TCP는 특정 프로세스와 연결된 외부 IP 주소를 확인할 수 있다.  **특히 연결 상태가 ESTABILISHED인 것은 현재 연결되어 데이터 송수신이 일어나고 있다는 의미이므로 해당 IP가 인가된 것인지 확인해 봐야 한다.**  **PID는 해당 연결을 사용하고 있는 프로세스의 아이디**를 나타내는데, **비인가 접속을 확인할 때 이용할 수 있는 중요한 수단**이다.  사용자가 인가하지 않은 프로세스가 해당 포트를 열고 외부와 통신하고 있을 경우, 침해당하고 있을 가능성이 높다.
   
   ​	**4) 공유 자원 정보**
   
   윈도우는 Server Message Block 프로토콜을 사용하여 동일 도메인 내에 시스템 사이의 자원을 공유할 수 있다. SMB는 Common Internet File System으로도 알려져 있다. SMB는 OSI 7 계층 중 application Lyaer에서 동작하는 프로토콜로 파일, 프린터와 같은 다양한 자원을 공유할 수 있게 해준다. 윈도우에서는 NET 명령어를 통해서 공유 자원으 ㅣ정보를 알아낼 수 있다.
   
   Window command
   
   - NET share
   
   SMB 프로토콜은 취약점이 많이 있는데, 몇몇 악성 코드의 경우 이 SMB 프로토콜에 있는 취약점을 이용하여 원격에서 코드를 실행할 수 있다. 따라서 사용자가 설정하지 않은 공유 정보를 파악하여 시스템의 침해 여부를 파악할 필요가 있다. NET SHARE는 현재 시스템에서 열린 공유 자원의 정보를 나타낸다. NET SESSION은 원격으로 시스템에 접근하여 사용되고 있는 자원을 나타낸다. NET FILE은 어떤 파일이 원격으로 사용되고 있는지를 나타내며 그 파일의 전체 경로 및 원격으로 접속한 사용자의 ID를 출력한다. 



## 윈도우 레지스트리 

1. **레지스트리 소개** 

   레지스트리는 마이크로소프트 윈도우 95 이후 버전에서 도입된 **환경 설정에 관한 일종의 데이터베이스**이다. **윈도우는 레지스트리에 운영체제 및 응용 프로그램 운영에 필요한 정보를 저장 및 관리한다.** 기존에는 ini 파일이나 cfg 파일 등에 나눠서 관리했지만 정보를 분산하여 생기는 과부하를 해결하기 위해 통일된 하나의 저장소로 관리하게 되었다. 레지스트리에는 부팅 과정에서 사용되는 정보뿐만 아니라 로그인, 서비스, 응용 프로그램, 사용자 등 윈도우 ㅅ스템에서 수행되는 많은 활동에 관여한다. 
   
   레지스트리는 마치 파일 시스템의 구성요소와 비슷하다. 파일 시스템에서 모든 파일은 폴더 내에 위치하는 것과 유사하게 레지스트리에서 모든 값은 키 내에 위치하며 키들은 계층구조이다. 
   
   **레지스트리는 실제 디스크 상에서 Hive라고 불리는 분리된 파일로 존재한다.**  윈도우 부팅과정에서 메모리에 적재되어 관리된다. Hive 파일은 레지스트리 정보를 디스크에 저장한 바이너리 파일이다. 이 파일은 시스템이 로그온 되면 시스템 커널 프로그램에 의해 관리된다. 
   
   | Hive File name               | path       | explanation                                          |
   | ---------------------------- | ---------- | ---------------------------------------------------- |
   | HKEY_USER\\.DEFAULT          | Default    | 사용자 계정이 생성될 때, 기본적으로 필요한 정보 저장 |
   | KKEY_LOCAL_MACHINE\\SOFTWARE | Software   | 응용 프로그램 정보                                   |
   | HKEY_LOCAL_MACHINE\\SAM      | Sam        | 사용자 계정 정보 저장                                |
   | HKEY_LOCAL_MACHINE\\SECURITY | Security   | 감사정책 및 권한 정보 저장                           |
   | HKEY_LOCAL_MACHINE\\SYSTEM   | System     | 하드웨어 드라이버 및 구성정보                        |
   | HKEY_USERS                   | Ntuser.dat | 사용자 계정에 설정된 정보 저장(계정마다 별도 존재)   |
   
   레지스트리의 HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentContolSet\\Control\\hivelist 경로에 각각에 해당하는 하이브 파일의 위치 정보가 저장되어 있다.  따라서 **포렌식 조사를 위해서는 레지스트리의 위치정보를 숙지하여 레지스트리를 분석해야한다.** 
   
   디지털 포렌식 조사 관점에서 레지스트리는 사용자의 활동 정보나 응용 프로그램 사용 흔적, 설치된 하드웨어 및 소프트웨어 정보, 네트워크 설정 정보와 같은 많은 **디지털 증거를 수집할 수 있는 포렌식 자원**이라고 할 수 있다. 특히 각각의 **키에 마지막 수정 시각이 기록되어 있기 때문에 일종의 로그로써 활용할 수 있다.** 
   
2. **레지스트리 포렌식 분석**

   ​	**1) 설치된 프로그램 목록**

   레지스트리의 HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall 경로에 설치된 프로그램의 이름, 버전, 게시자, 설치 시각, 설치 위치, 소스 경로가 저장되어 있다. 

   하위 키는 설치된 응용 프로그램의 목록을 가르키고, 값에 설치된 프로그램 정보가 저장되어 있다.

   사용자가 최소 한번이라도 응용 프로그램을 실행했을 경우, 레지스트리 HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\ {5E6AB780-7743-11CF-A12B-00AA004AE837}\\Count 경로에 실행한 프로그램의 경로와 실행 유형, 실행 횟수, 최종 실행 시간이 저장된다. 

   값은 ROT13(Caesar cipher)으로 암호화되어있다. ROT13은 Rotate by 13 places의 줄임말로 치환암호 이다. 실행시간은 FILETIME 형식으로 저장된다. 

   ​	**2) 최근 사용된 HWP 문서 파일**

   HWP는 한글과 컴퓨터 사에서 개발하고 발표하는 한글 워드 프로세스 프로그램이다. 레지스트리에는 유니코드 형식으로 저장되어 있으며 , file0이 가장 최근에 사용한 문서이다. 
   경로 : HKEY_CURRENT_USER \\ Software \\ HNC \\ Hwp \\ version(7.0) \\ HwpFrame \\ Recent File

   ​	**3) 최근에 사용된 Microsoft Offic 문서 파일**

   마이크로 소프트 오피스의 경우 최근 문서가 최대 50개까지 저장된다.

   경로 : HKE_UCURRENT_USER \\ Software \\ Microsoft \\ Office \\ 12.0 \\ E, P, W \\ File MRU 경로에 저장 

   ​	**4) USB 외부 저장 장치 사용 이력**
   Universal Serial Bus에 장치를 연결하면 관련 드라이버 정보 등이 레지스트리에 저장되는데 이 정보를 분석하여 대상 시스템에 연결한 USB 저장 장치 사용 이력을 조사할 수 있다. 

   경로 : HKEY_LOCAL_MACHINE \\ SYSTEM \\ Current ControlSet \\ Enum \\ USBSTOR

   USBSTOR 하위키는 Device Type & Vendor String & Product String & Version Inforamtion 과 같은 형태로 기록되어 있다. Device Type은 해당 장치의 종류를 나타낸다. 주로 Disk 나 CDROM이 나타난다. Vendor String에는 제조사, Product String은 제품 이름, Version information에는 제품 버전이 기록된다. 

   ​	**5) 최근 접근 문서**

   윈도우 탐색기를 사용해서 'Double Click'을 통해 열람된 파일 목록 정보도 볼 수 있다.

   경로 : HKEY_CURRENT_USER \\ Software \\ Mircrosoft \\ Windows \\ CurrentVersion \\ Explorer \\ RecentDocs

   하위키는 확장자 별로 구분하여 사용된 문서 정보를 저장한다. 해당 값은 유니코드로 저장된다. 

   ​	**6) 접근한 인터넷 주소 목록**

   웹 브라우저 주소창에 기록하는 주소 목록을 기록한다. 

   경로 : HKEY_CURRENT_USER \\ Software \\ Microsoft \\ Internet Explorer \\ TypedURLs 

   이 정보를 분석하면 사용자가 자주 접속하는 웹 페이지, 주제, 키워드 등을 유추할 수 있다. 하지만 익스플로러 7부터는 활용하지 않는다. 

   ​	**7) 최근 실행 명령어**

   경로 : HKEY_CURRENT_USER \\ Software \\ Microsoft \\ Windows \\ Current  Version \\ Explorer \\ Run MRU

   실행한 순서는 MRUList 값에 나타난다. 이 값은 가장 최근에 사용된 명령어 순서로 값 정보를 저장한 배열이다.

## 웹 브라우저 

1. **개요**
   웹 브라우저는 인터넷을 사용하기 위한 가장 기본적인 소프트웨어로서 검색, 쇼핑, 통신, 금융 파일, 다운로드 등 많은 곳에 사용된다. 범죄 행위에도 웹 브라우저가 사용되는데 불법 사이트에 접속하는 것, 저작권이 있는 소프트웨어와 파일을 불법적으로 다운로드하거나 유포하는 것, 범죄를 위한 정보 수집의 일환 등이 대표적인 예이다. 

   웹 브라우저는 대부분의 인터넷 사용 내역을 웹 브라우저 생성 파일에 기록한다. 따라서 웹 브라우저 생성 파일을 분석하여 용의자의 웹 브라우저 사용정보를 조사하면 범죄 행위에 대한 간접적 증거를 추출할 수 있다. 하지만 일반적으로 많은 양의 사용 내역이 저장되어 있어 별도의 도구를 사용하지 않는다면 분석이 쉽지 않다.  

2. **Interent Explorer 분석**

   ​	**1) 개요**

   Interent Explorer는 Temporary Internet File, Cookies, History 폴도에 인터넷 사용 정보를 저장한다. Temporary Internet File 폴더는 웹 서버로부터 불러온 임시 파일을 저장하며 Cookies 폴더는 쿠키 파일을, History 폴더는 사용자가 접속한 웹 사이트의 목록을 저장한다. 각 폴더 모두 index.dat 파일을 통하여 관련 정보를 관리한다. 

   ​	**2) Web History**

   History 폴더는 사용자가 웹 브라우저를 통해 방문한 URL을 저장한다. 구체적으로 History의 index.dat 파일은 접속한 url, 다운로드 받은 파일, 마지막 방문 시간을 확인할 수 있다. 

   History의 index.dat 파일에서 피의자가 검색한 검색어를 추출하기 위해서는 각 검색 사이트마다 쿼리 내용과 인코딩 방법을 분석해야 한다. 

   다운로드 받은 파일의 경우 Activity Record의 url은 "file:///"로 시작하며 다운로드한 파일의 위치에 대한 정보가 저장된다. 예를 들어 웹사이트에서 abcd.txt 파일을 c:/ 에 저장하였다면 Activity Record의 url은 "file:///c:/abcd.txt"로 저장된다. 파일을 다운후에 옮겼다면 위치는 알 수 없다.

   ​	**3) 임시 인터넷 파일**

   Temporary Internet File 폴더는 웹 브라우저의 성능을 높이기 위하여 서버로부터 가져온 임시 파일을 저장하여 놓는다. 이후 같은 서버에서 같은 파일을 가져와야 하는 경우에 저장된 파일을 이용하여 화면에 출력함으로써 속도를 향상 시킨다. 

   이러한 정보는 특정 시점 전후로 사용자가 어떠한 행동을 했는지 알 수 있게 해준다. 예를 들어 웹 메일을 사용하였다면 웹 메일의 정보가 Temporary Interent File에 저장되었을 가능성이 크다. 웹 메일의 경우 Activity Record의 url에서 mail이라는 키워드 검색을 통해 알 수 있다. 문서역시 마찬가지로 가능하다. 

   ​	**4) 쿠키 파일**

   Cookies 폴더는 웹 사이트에서 사용자와 관련된 정보를 사용자의 하드 디스크에 저장한다. Cookies 파일의 index.dat 파일에는 Cookies를 저장하는 사이트의 URL과, 생성시간, 최근 접근 시간, 정보를 저장하는 쿠키 파일의 이름을 확인할 수 있다. 이를 통해 해당 사이트의 쿠키 파일 이름을 확인할 수 있고, 마지막으로 언제 수정되었는지 알 수 있다. 
   
3. **Fire Fox 분석**

   ​	**1) 개요**

   FireFox는 Internet Explorer와 마찬 가지로 임시 파일, 웹 히스토리 ,쿠키를 저장한다. 

   FireFox2는 Cache, history.dat, cookies.txt에 인터넷 사용 정보를 저장하며 FireFox3은 Cache, places.sqlite, cookies.sqlite에 인터넷 사용 정보를 저장한다. Cache 폴더는 임시 파일을 저장하는 폴더이며 FireFox2, 3 모두 동일한 방법으로 Cache 폴더를 사용한다. history.dat, Places.sqlite는 둘 다 웹 히스토리를 저장하지만 파일 포맷이 서로 다르며, cookies.txt, cookies.sqlite는 둘 다 쿠키 파일을 저장하지만 파일 포맷이 서로 다르다. 

   FireFox3는 Cache, places.sqlite, cookies.sqlite에 인터넷 사용정보를 저장한다. places.sqlite, cookies.sqlite는 웹 히스토리를 저장하는 파일로서 이름에서도 알 수 있듯이 SQLite database 파일이다. SQLite는 SQL 92 표준에 맞춰 구현된 임베디드 데이터베이스 라이브러리이며 일반적으로 데이터베이스처럼 데몬을 구동하는 방식이 아니라 ,엔진이라 할 수 있는 하나의 라이브러리에 데이터베이스 인터페이스를 병합한 형태이다. Cache는 임시 파일을 저장하며 그 구조와 임시 파일의 저장 방식이 Fire Fox2와 같다. **Places.sqlite는 웹 히스토리를, cookies.sqlite는 쿠키를 저장한다.**

   ​	**2) 웹 사용 기록**

   places.sqlite에서 사용자의 웹 사용 기록을 추저갛기 위해 참조해야 할 테이블은 크게 2가지 이다. 하나는 moz_places 테이블이고 다른 하나는 moz_historyvisits 테이블이다. 

   moz_places 테이블은 사용자가 방문한 웹 사이트의 url과 해당 웹 페이지 제목, 방문한 횟수, 주소를 직접 입력하여 접속하였는지 여부 등의 정보를 제공하지만 중요한 정보가 되는 시간에 대한 정보는 제공하지 않는다. 사용자가 해당 웹 사이트를 방문한 시간 정보를 알기 위해서는 moz_historyvisits 테이블의 visit_date를 참조해야 한다. moz_historyvisits의 테이블의 places_id는 moz_places 테이블의 id를 뜻한다. 따라서 moz_places 테이블의 id와 moz_historyvisits 테이블의 places_id를 결합하면 사용자가 해당 url에 접속하였을 때의 시간 정보를 알 수 있다. 

   ​	**3) 쿠키 파일**

   cookies.sqlite는 쿠키를 저장하는 파일이다. cookies.sqlite는 moz_cookies라는 한 개의 테이블이 존재한다. moz_cookies는 호스트 이름, 폐기 날짜, 값, 값의 이름, 마지막 접근 시간 등의 정보를 제공한다.
   

## 인터넷 메신저 

1. **인터넷 메신저 소개**

   인터넷 메신저는 네트워크를 통해 두 명 이상의 실시간 통신에 이용되는 프로그램을 말한다. 일반적으로 간단하게 메신저라고 부른다. 메신저는 상대방과 대화를 서로 한 줄씩 입력할 때 마다 내용을 전송하며, 대부분의 메신저에서 실시간으로 상대방 PC에 파일 전송이 가능하기 때문에, 다른 서비스에 비해 정보의 전송에 용이한 수단이라 볼 수 있다. 이러한 이유로 대부분의 PC 사용자가 메신저 서비스에 가입하여 사용하고 있다. **디지털 포렌식 관점에서는 메신저 프로그램이 남기는 정보를 통해 사용자의 활동을 파악해 볼 수 있다.** 

   대부분의 메신저 서비스는 현재 접속해 있고 대화가 가능한 상대의 목록을 보여주는 접속자 정보 기능을 제공한다. 이것을 흔히 '친구 목록'이라고 부른다. 그리고 사용자가 서비스에 접속할 떄, 편의성을 제공하기 위해 계정명 및 패스워드 등의 계정 정보를 저장하게 된다. 이러한 정보들이 PC에 파일이나 윈도우 레지스트리의 형태로 남아있는 경우에 한해서 해당 정보들을 복구하여 포렌식 조사에 활용할 수 있다. 

2. **주요 분석 대상 정보**

   ​	**1) 설치 정보**

   대부분의 메신저는 설치 경로, 프로그램 버전 등의 정보를 레지스트리에 저장한다. 이를 통해서 메신저 사용자가 어떤 메신저를 설치해 사용하였는지 확인해 볼 수 있다. 

   야후 메신저와 같은 일부 메신저는 대화 내용을 저장하기 위한 경로를 따로 설정하지 않고 프로그램 파일이 존재하는 디렉토리 하위에 대화 내용을 저장하기 때문에 프로그램이 설치되어 있는 경로의 파악은 매우 중요하다. 또한 메신저 설정 파일 등의 핵심 파일이 프로그램이 설치된 경로에 존재하는 경우가 많기 때문에 반드시 파악해야 할 정보 중 하나이다. 

   ​	**2) 계정별 정보**

   대부분의 메신저는 메신저 서비스를 이용하기 위한 설정 정보를 계정별로 저장하게 되는데, 이러한 계정별 정보는 일반적으로 레지스트리에 저장된다. 레지스트리에 계정별로 저장되는 정보는 대화내역 저장 경로, 다운로드 파일 저장 경로, 자동 로그인 계정명 및 패스워드 등이다. 

   다운로드 파일 저장 경로를 통해 사용자가 다운로드 받은 파일을 확인 및 분석할 수 있으며, 자동 로그인 계정명을 통해 최종적으로 어떠한 계정을 사용하였는지 파악하여 포렌식 조사에 도움이 될 수 있다. 

   ​	**3) 대화내역 정보**

   메신저로 대화를 시도하는 경우 대부분의 메신저는 대화의 저장 여부를 묻는다. 대화를 저장하도록 설정하는 경우에 한해서 대화내역이 PC에 저장되는데, 이룹 메신저는 이를 암호화기로 한다. 하지만 WLM과 같이 대화내역을 암호화하지 않고 텍스트 형태로 남는 경우도 있다. 

   메신저는 요새 많이 사용하기 때문에 대화내역 및 파일 송수신 정보를 파악하는 일은 매우 중요하다. 

3. **주요 메신저 별 포렌식 분석**

   ​	**1) Windows Live Messenger**

   ​		**가) 설치 정보**

   ​	Windows Live Messenger는 윈도우 레지스트리의 HKCU \\ Software \\ Microsfot \\ MSNMessenger 키의 하위에 설치 경로, 프로그램 버전 및 기타 설정 정보들을 기록한다. 

   키 하위의 "MachineGuid"값은 메신저가 설치된 PC의 GUID를 가르키며, MachineName은 PC의 이름을 가르킨다. 

   PerPassportSetting 키의 DefaultMemberName은 메신저 실행 후에 기본적으로 보이는 계정명이며, 가장 최근에 접속한 계정이라고 유추할 수 있다. SQM 키의 TotalUpTime은 메신저 서비스에 로그인하여 사용한 총 시간을 초 단위로 기록하고 있다.
   
   ​	**나) 계정별 정보**
   
   Windows Live Messenger는 윈도우 레지스트리의 "HKCU\\Software\\Microsoft\\MSNMessenger\\PerPassportSettings" 키의 하위에 각 사용자를 구분하기 위한 passport 번호로 하위키를 만들어 사용자별 계정정보를 기록한다. **가장 중요한 정보는 Message Log Path 값이다.** 여기에는 각 계정의 **대화내역 정보가 저장되는 경로**가 저장된다. 
   
   또한 Windows Live Messenger는 자동 로그인을 위한 계정 및 패스워드 정보를 저장하기 위해 윈도우 시스템의 Credential Management를 이용한다. 
   
   ​	**다) 대화내역 정보**
   
   Windows Live Messenger는 대화내역을 저장하는 경우, 앞서 설명한 계정별 정보 항목에서 확인 가능한 경로에 XML 형식으로 저장하게 된다. 상대방 계정 별로 "계정명 + PassPort 번호.xml" 형식의 파일이름을 가진다. 이를 웹브라우저로 열면 쉽게 확인할 수 있다. 
   
   **2) Yahoo! Messenger**
   
   ​	**가) 설치 정보**
   
   Yahoo! Messenger 는 윈도우 레즈스티리의 "HKCU\\Software\\Yahoo\\pager" 키의 하위에 설치 경로, 프로그램 버전 및 기타 설정 정보들이 기록된다. 
   
   ​	**나) 계정 정보**
   
   Yahoo! Messenger는 앞서 설명한 설치 정보가 기록되어 있는 레지스트리 키의 하위에 "Yahoo! User ID"라는 값으로 가장 최근에 접속한 사용자의 계정명을 저장해준다. 
   
   "HKCU\\Software\\Yahoo\\pager\\profiles" 키에는 계정명과 같은 하위키가 생성되는데, 이는 한번이라도 접속을 시도했을 경우에 생성된다. 또한, 해당 계정 키 하위에 "Alerts"키의 "Total Login Tries" 값이 나타내는 데이터는 로그인이 실패했을 경우 총 몇 번의 로그인을 시도하였는지 나타낸다. 따라서 해당 키를 통해 어떤 계층으로 몇번의 로그인 시도가 있었는지를 파악할 수 있다. 
   
   ​	**다) 대화내역 정보**
   
   대화내역 저장 옵션을 선택하는 경우에 한해 <설치경로>\\Profiles\\<사용자계정>\\Archive\\Messeages\\<상대방계정>\\<년원일>-<사용자계정>.dat 의 경로에 대화내역 파일을 저장하게 된다. 
   
   대화 내역 파일에서 추출한 대화 내용은 UTF-8로 인코딩 되어 있으며, 일반 텍스트 형식이 아닌 사용자 계정명과 XOR를 통해 저장되어 있다. 따라서 디코딩 과정을 통해야 대화내용을 확인해 볼 수 있다. 
   
   **3) NateOn**
   
   ​	**가) 설치 정보**
   
   NateOn은 윈도우 레즈스티리의 HKCU\\Software\\SK Communications\\Messenger 키의 하위에 프로그램 버전 및 기타 설정 정보들을 기록한다. 
   
   ​	**나) 계정 정보**
   
   NateOn은 앞서 설명한 설치 정보가 기록되어 있는 레지스트리 키의 하위에 존재하는 "Setting" 키 안의 "User ID" 값에 최근에 접속한 계정을 저장해준다. 또한 "UserKey"라는 항목으로 자동 로그인을 위한 토큰을 저장해 둔다. 이는 PC의 MAC주소 등 고유한 정보를 통해 생성된다.
   
   ​	**다) 기타 정보**
   
   버전이 업그레이드 되면서 기존에 파일로 저장되던 모든 대화 및 쪽지 내역이 외부 서버로 저장되도록 변경되어, 기록을 남기지 않는다. 따라서 로컬 시스템에서 획득할 수 있는 자료는 많지 않다. 
