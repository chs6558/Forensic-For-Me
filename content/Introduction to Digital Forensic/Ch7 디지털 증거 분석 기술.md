---
title: "7장 디지털 증거 분석 기술"
metaTitle: ""
metaDescription: ""
---

## 디스크 브라우징 기술

증거 분석의 1차 목표는 자료를 검색하여 사건의 단서를 찾는 것이다. 수집된 저장 매체 또는 하드 디스크 이미지는 특정 파일 시스템으로 구성되며, 그 내부에는 다양한 파일들이 존재한다. 각 파일들은 해당 응용 프로그램을 구동해서 그 내용을 열람할 수 있으나, 해당 응용 프로그램을 매번 구동해야 하는 번거로움이 있다. 

**디스크 브라우징이란?** 

- **저장 매체 또는 하드 디스크 이미지의 내부 구조와 파일 시스템을 확인하고, 내부에 존재하는 파일들에 대응되는 응용 프로그램의 구동 없이 쉽고 빠르게 분석할 수 있도록 하는 기법**

Encase를 이용하여 디스크 브라우징을 할 수 있다. 

## 데이터 뷰잉 기술

디지털 증거를 효율적으로 분석하기 위해서는 데이터를 **가시적**으로 확인할 수 있어야 한다. 

이렇게 가시적으로 출력하는 것을 **data viewing**이라고 한다.

window 레지스트리 파일에는 디지털 포렌식 관점에서 의미있는 데이터가 많이 포함되어 있지만, hex-editor로 확인하기에는 많은 어려움이 있다. 대부분의 디지털 데이터는 정해진 포맷이 있기 때문에 이를 가시적으로 확인하기 위한 viewing 기술이 필요하다. 

**REGA : 윈도우 registry 분석 도구** 

## 검색 기술

저장매체가 대용량화 되면서, 디지털 데이터의 양이 많아지고 있는 추세이다. 이로 인해 많은 시간이 걸리게된다. 이를 극복하기 위해 고속 검색 기술 개발이 연구의 이슈가 되었다. 

1. **키워드 검색**

   디지털 데이터가 준비되면 사건과 관련된 키워드를 선정하여 파일 또는 저장매체 전체를 대상으로 검색한다. 디지털 포렌식 분석 과정에서 키워드 검색을 통해 증거를 찾기 위해서는 **텍스트 인코딩, 대/소문자 등의 사항을 고려**해야 한다. 

   Encase에도 키워드 검색 기능이 있다. (GREP : Grobally Find Regular-Expression and Print)

   | 정규 표현식 | 의 미                                      | 사용 예제                                            |
   | ----------- | ------------------------------------------ | ---------------------------------------------------- |
   | ^           | 문자열의 처음                              | ^aaa : 문자열의 처음에 aaa를 포함하면 매칭           |
   | $           | 문자열의 끝                                | aaa$ : 문자열의 끝에 aaa를 포함하면 매칭             |
   | .           | 하나의 문자 매칭                           | .lue : alue, blue, clue.. .                          |
   | ?           | 바로 이전 문자의 빈도가 0 or 1인 경우 매칭 | forensic? : forensic 또는 forensics                  |
   | *           | 바로 이전 문자의 빈도가 0이상인 경우 매칭  | digital_*for : digitalfor, digital_for, digital__for |
   | +           | 바로 이전 문자의 빈도가 1이상이 경우 매칭  | digital_+for : digital_for, digital__for ...         |
   | [ABC]       | A,B,C중의 하나의 문자 매칭                 | dig[ei]tal : digetal, digital                        |
   | [^ABC]      | A,B,C 이외의 문자 매칭                     | dig[ ^i]tal : digetal, digftal ... digital 제외      |
   | [A-C]       | A부터 C중에 하나의 문자 매칭               | [a-d] : a, b, c, d<br />[1-2] : 1, 2                 |
   | \           | 특수문자를 일반 문자로 사용하는 경우       | [? [ \ ] ] : ?, [, ]                                 |
   | X{M}        | 문자 X를 M번 반복                          | h{3} : h가 3번이상 반복 ,(hhh, hhhh ....)            |
   | X{M,N}      | 문자 X를 M회 이상 N회 이하 반복            | h{3,5 } : h가 3번이상 5번 이하 hhh hhhh hhhhh        |
   | a \| b      | a, b 둘중에 하나인 경우 매칭               | web\.(com)\|(net) : web.com, web.net                 |

   일반적인 키워드 검색이 파일 또는 저장 매체의 첫 시작 위치에서부터 순차적으로 해당 키워드를 찾는 것이라면, 전처리를 통해 키워드들을 미리 **indexing 해놓음으로써 빠른 검색**이 가능하게하는 기술도 있다.  대표적인 방법은 dtSearch라는 방법이 있다. 

   

2. **파일 검색**

   **파일명 또는 파일의 해쉬 값을 이용하여 저장 매체 내에서 특정 파일을 검색하는 것**을 파일검색이라고 한다. 

   **해쉬값을 이용한 파일 검색은 미리 알려진 파일을 포렌식 분석 대상에서 제외하기 위해 활용**한다. 대량의 디지털 데이터에서 사건과 관련이 없는 잘 알려진 파일들을 제외시킴으로써 분석 대상을 축소시키는 것이다. 

   이러한 기능을 하기 위해 잘 알려진 파일들의 해쉬 값을 모아 놓은 것을 Reference Data Set 이라고 한다. 

   대다수의 디지털 포렌식 전문 도구에서는 NSRL과 같은 참조 데이터 세트를 이용해서 파일 검색을 할 수 있는 기능을 제공한다. 

## 타임라인 분석

**디지털 데이터에서 시간은 범죄 사실을 규명하기 위해 매우 중요한 정보이다.**  파일 시스템 상에 저장되는 파일의 시간 정보, 파일 내부의 메타 데이터에 저장되는 시간 정보 등 다양한 곳에 저장되어 있는 시간 정보를 이용해 타임라인을 구성함으로써 시스템 사용자의 행위를 추적할 수 있다. 

파일 시스템에 저장되어 있는 시간과는 별도로 **문서 파일, 압축 파일 등은 파일 내부에 고유한 형식으로 시간 정보를 저장하고 있다.** 파일 내부에 저장되는 이러한 시간 정보는 파일이 복사, 이동 , 수정되는 과정에도 변경되지 않으며, 전문 지식이 없는 경우에는 **조작이 용이하지 않기 때문에 핵심 증거로 사용될 가능성이 있다.** 

## 통계 분석

**통계 분석을 통해서 해당 시스템의 사용 용도를 파악하거나 사용자의 성향을 분석할 수 있다.** 파일 확장자의 통계를 통해 어떠한 용도로 컴퓨터가 많이 사용되었는지 알 수 있다. 

## 로그 분석

**LOG란 시스템에 접속한 사용자의 행위를 저장해 놓은 기록**이다. 로그를 이용하여 외부 침입의 흔적과 사용자가 어떤일을 했는지 등의 정보를 알 수 있다. **침해사고를 비롯한 디지털 포렌식 조사 과정에서 기본적으로 행해지는 분석 중의 하나가 로그 분석이다.** 

- 유닉스 시스템 계열 로그
- 윈도우 시스템 계열 로그
- 웹 로그

1. **유닉스 시스템 로그** 

   유닉스 시스템 계열 로그 파일은 그 종류 및 위치가 시스템마다 조금씩 다르다. 

   | 유닉스 시스템 | 디렉터리 |
   | ------------- | -------- |
   | HP-UX         | /usr/adm |
   | Solaris, AIX  | /var/adm |
   | Linux, BSD    | /var/log |

   로그 파일의 종류 및 기본적인 기능은 아래와 같다.

   | 파일명        | 기능                                                         |
   | ------------- | ------------------------------------------------------------ |
   | acct or pacct | 사용자별로 실행되는 모든 명령어를 기록                       |
   | aculog        | dial-out 모뎀 관련 기록 (자동 호출 장치)                     |
   | lastlog       | 각 사용자의 가장 최근 로그인 시간을 기록                     |
   | loginlog      | 실패한 로그인 시도를 기록                                    |
   | messages      | boot message 등 시스템의 콘솔에서 출력된 결과를 기록하고<br />syslog에 의하여 생성된 메시지도 기록 |
   | sulog         | su 명령 사용 내용 기록                                       |
   | utmp          | 현재 로그인한 사용자의 기록                                  |
   | utmpx         | utmp 기능 확장, 원격 호스트 관련 정보 등 자료 구조 확장      |
   | wtmp          | 사용자의 로그인, 로그아웃 시간과 시스템의 종료 시간, 시작 시간 등 |
   | wtmp          | wtmp 기능 확장                                               |
   | vold.log      | CD-ROM과 같은 외부매체에서 사용되는 에러                     |
   | xferlog       | FTP 데몬의 접근 기록                                         |

   - log 파일들을 cat으로 읽으니 읽어지지 않았다. last -f 파일명 을 이용하여 읽을 수 있었다. 

2. **윈도우 시스템 로그 분석**

   윈도우 운영체제는 기본적으로 event log를 시스템 운영 전반에 걸쳐서 저장하고 있다. 조사자는 event log 분석을 통해 해당 시스템의 전반적인 동작을 알 수 있다. 

   - **응용 프로그램 이벤트** : 응용 프로그램이나 기타프로그램의 동작에 대한 이벤트로, 기록되는 이벤트는 소프트웨어 개발자에 의해 결정된다. 
   - **보안 이벤트** : 유효하거나 유효하지 않은 로그온 시도 및 파일 생성, 열람, 삭제 등에 관련된 이벤트
   - **시스템 이벤트** : 윈도우 시스템 구성요소가 기록하는 이벤트

   윈도우 XP를 기준으로 WIDNOWS\system32\config 폴더에 위치한다. 

   window의 로그는 기본적인 프로그램인 이벤트 뷰어를 이용하여 확인이 가능하다. 

   

3. **웹 로그 분석**

   웹 로그는 웹 서비스를 제공하는 웹 서버의 종류에 따라 각기 다른 형태로 저장된다. 대부분의 웹 로그는 CLF( Common Log Format )로 파일을 생성하며, 웹서버와 종류에 따라 조금씩 차이가 있다.

   - Host : 클라이언트의 호스트 이름이나 IP 주소
   - Authuser : 인증이 필요한 경우 사용자 이름 기록
   - Date : 접속한 시간과 날짜 기록
   - Request : 클라이언트가 요청한 메시지
   - Status : 요청한 것에 대한 서버의 처리사항 (상태 코드)
   - Bytes : 전송된 Bytes의 크기 (head 제외)

4. **로그 분석 도구**

   1) Event Log Explorer

   윈도우 시스템의 이벤트 로그를 분석하는 도구 개인사용자라면 무료로 이용가능. 로그 데이터의 정렬과 검색 기능을 제공하여 사용자가 원하는 정보를 쉽게 얻을 수 있고 각 로그에 대한 부가 설명과 바이너리 데이터를 제공하여 로그 분석을 용이하게 한다. 

   2) Log Parser

   커맨드 라인에서 실행하는 도구로 텍스트 기반의 로그를 SQL query를 이용하여 분석할게 해주는 도구이다. 로그 종류에 상관없이 text 기반이면 모두 가능하다. 

## 시각화 기술

시각화는 **보이지 않는 것을 일정한 형태로 나타내거나 가려져 있던 어떤 현상이나 실체가 눈에 띄게 드러나게 하는 것으로 추상적인 자료를 사람이 인지할 수 있는 형태로 만드는 과정**을 의미한다. 시각화는 방대한 양의 데이터에 대해 빠른 이해를 해주게 하고, 데이터의 특정 패턴을 인식하는데 매우 유용하다. 

디지털 포렌식 조사 시에 데이터의 양이 방대하여 시간이 오래 걸리는데, 이러한 시각화를 통해 제한 시간안에 많은 정보를 처리할 수 있으며, 이해하기 쉬운 자료를 생산할 수 있다. 

Open knowledge Viewer라는 도구를 사용하여 손 쉽게 파악할 수 있다. 

## 안티 포렌식 대응 기술

안티 포렌식이란 포렌식 기술에 대응하여 자신에게 불리하게 작용할 가능성이 있는 증거물을 차단하려는 일련의 활동을 말한다. 

1. **데이터 복구**

   데이터 복구는 저장 매체의 비할당 영역으로부터 삭제된 데이터를 복구하는 기술이다. 

   파일을 삭제하면, 파일시스템에서는 변화가 일어난다. 파일이 존재할 떄는 그 파일에 해당하는 정보가 할당영역에 존재하다가 삭제를하면 비할당 영역으로 넘어간다. 하지만 데이터는 남아 있어 비할당영역에 존재하게 된다. 이러한 데이터는 새로운 파일이 덮어 씌워지지 않으면, 복구 도구를 통해 복구할 수 있다. 

   이와 같이 삭제된 파일은 복구 가능하기 때문에 프라이버스 관련 정보나 영업 비밀 관련 정보와 같이 중요한 데이터를 파기할 떄는 wiping 기술을 사용한다. 

   하지만 wiping은 증거 인멸 기술로도 사용되고 있으며 현재까지 이에 대한 대책은 없다.

2. **패스워드 검색**

   조사 과정에서 사건과 관련된 중요한 데이터가 암호화 되어 있을 수 있다. 암호화된 데이터는 사용자가 입력한 패스워드를 키로 사용하게 되는데, 사회공학적 기법 ,사전 공격, 전수 조사 등의 방법이 있다. 

   **암호화된 파일의 패스워드를 알아내기 위해서는 해당 응용 프로그램에서 사용하는 암호화 키 검증 알고리즘을 분석해야 한다.** 

3. **심증 암호 분석**

   - 멀티 미디어 파일 분석 : 이미지, 동영상 등의 파일에 은닉된 데이터를 탐지하는 기술
   - 문서 파일 분석 : MS Office, 한글 등의 파일에 은닉된 데이터를 탐지하는 기술로 저장 형식 분석을 통해 탐지할 수 있다. 

4. **파일 내부의 시간 정보 분석**

   파일 시스템 상에 저장되는 시간 정보는 변조가 용이하다. 그러나 응용 프로그램에 의해 파일 내부에 저장되는 시간 정보는 해당 파일의 저장 형식을 알지 못하면 변경하기 어렵다. 따라서  **파일 내부에 저장된 시간 정보 분석은 디지털 포렌식 조사에서 중요하게 활용될 수 있다.** 

## 기타 분석 기술

1. **일관성 분석**

   **시간의 연속성이라는 특성을 이용하는 분석 방법**이다. 어떤 결과가 발생하려면 반드시 원인이 존재해야 한다는 사실을 기반으로 한다. 파일, 파일의 메타데이터, 로그 등 데이터에는 시간 정보가 저장되므로 이를 이용하여 일관성 분석을 할 수 있다. 

2. **연관 관계 분석**

   **서로 다른 이벤트 사이의 연관 관계를 밝히는 분석 방법**이다. A와 B이벤트가 함께 발생했을 때만 C 이벤트가 일어난다고 가정했을 때, A B C 이벤트 각각을 기준으로 분석하는 경우에는 관계가 없다고 할 수 있다. 이러한 상황에서 통계, 데이터 마이닝 등의 기법을 사용해 관계를 밝히는 것이 연관 관계 분석이라고 한다. 