---
title: "12장 침해사고 조사 절차"
metaTitle: ""
metaDescription: ""
---

**침해사고란?**

해킹, 컴퓨터 바이러스, 논리폭탄, 메일폭탄, 서비스 거부 또는 고출력전자기파 등의 방법으로 정보 통신망 또는 이와 관련도니 정보시스템을 공격하는 행위를 하여 발생한 사태를 의미한다.

시스템 또는 특정 서비스의 취약점을 이용하거나 사용자에게 악성 코드를 실행하도록 유도하는 형태로 발생되며 스팸 메일의 대량 발송, 비인가된 네트워크에 접근 및 정보 수집 등 결과를 초래한다. 침해사고가 발생하면 초기에 신속히 대응하여 피해 확산을 방지하는 것이 매우 중요하다.  

**침해 사고 대응 절차**

사전대응 --> 사고탐지 --> 초기대응 --> 사고조사 --> 보고서 작성

## 사전 대응

실제로 침해 사고가 발생하기 전 단계로 침해 사고를 예방하고 침해 사고가 발생하였을 경우, 신속히 대철할 수 있는 준비를 수행하는 단계. 

**가. 사고 예방 체계 구축**

공격자의 공격 방법이 발달함에 따라 침해 사고를 완벽하게 예방하는 것은 불가능 하다. 하지만 취약점이 발표되기 전에 발생하는 제로데이 공격을 제외하면 대부분의 공격이 기존에 알려진 방법을 통해 발생하므로 사전에 예방 가능하다. 

시스템 및 서비스에 대한 보안 패치를 최신화 하고, 네트워크 및 세스템에 대한 접근 제어를 수행해야 한다. 무언가를 다운로드할 때는 항상 주의한다.

**나. 사고 대응 체계 구축**

침해 사고는 항상 예측하기 힘든 상태에서 발생하므로 여러 상황에서 신속히 대응할 수 있는 훈련된 사고 대응팀을 조직해야 한다.  사고 대응팀은 침해 사고가 발생했을 때 신속히 대응하기 위해 침해 사고 유형에 따라 관련된 기술을 개발하고, 필요한 도구를 준비하며, 이 훈련을 수행하여 현장에서 즉시 대응할 수 있는 체계를 구축해야 한다. 

**다. 사고 후 복구 체계 구축**

침해 사고에 대한 조사가 끝나고 문제가 해결된 뒤에는 사업의 연속성을 위해 신속히 복구 과정을 수행해야 한다. 

## 사고 탐지

침해 사실이 발견되는 단계이다. 침해 사실이 즉각 발견될 수 있지만 ,주로 다소 시간이 지난 후에 발견된다. 

침해 사고 발생 징후는 보안 경고 외에도, 웹 페이지의 변조, 급격한 네트워크 트래픽 발생, 정체 불명의 파일 발견, 시스템의 오동작, 고객의 피해 신고 등 다양하게 발견된다. 

## 초기 대응

발견된 이상 현상에 대해 정보를 수집하고 침해 사고 여부를 파악하는 단계이다. 모든 사고에 있어서 가장 중요한 단계로, 조사하고 증거를 보존하며, 사고 대응 절차에 따라서 관련자에게 연락 및 비상 대응팀을 소집해야 한다. 

침해 사고로 판단할 수 있는 근거는 악성코드 발견, 홈페이지 변조, 등이 있으며, 현황은 고객 정보 노출, 파일 변조, 다량의 이상 패킷 발생 등이 될 수 있다. 

초기 대응 시 유념해야 하는 것은 증거의 무결성을 훼손해서는 안된다는 것이다. 피해를 최소화 하는 것도 중요한 일이지만, 복구에 집중한 나머지 증거를 훼손하게 된다면 침해 경로와 피해 규모를 파악하는데 어려움이 발생한다. 

**어떠한 상황이라도 네트워크 접속 정보, 메모리 등 과 같은 휘발성 데이터에 대한 증거 자료 수집이 필요한 경우에는 즉각 실시하는 것이 바람직 하다. **

## 사고 조사

사고 조사자가 본격적으로 투입되어 사고의 범위를 구분하고 증거 자료를 수집하고 분석하는 가장 핵심적인 단계이다. 조사자는 효율적인 사고 분석과 계획을 수립하기 위해 필요한 정보 및 자원을 수집하고 조사 범위를 한정한다. 

**가. 조사 범위 규정**

사고 조사에서 가장 먼저 이루어져야 하는 단계이다. 시간, 자원에 대한 제한이 없다면 모든 범위를 조사하는 것이 좋지만,  대부분 제약이 있기 때문에 조사 범위를 선정하는 것이 필요하다. 

​	**1) 초기 대응에서 수집된 정보**

이 정보는 사고의 인지 시점과 피해 현상, 초기 대응을 어떤 방법으로 했는지 알 수 있는 자료가 된다. 이를 이용해 사고의 성격과 피해량, 필요한 정보와 조사 대상을 파악할 수 있다. 

​	**2) 네트워크 구성도**

침해 사고 조사를 위해서 꼭 필요한 저오이다. 시스템의 물리적, 논리적 연결 상태, 연계되어 있는 시스템이 어떤 것인지를 파악하여 피해규모, 침입 경로, 시나리오 등에 대한 가설을 세울 수 있다. 

​	**3) 정보시스템 관리자/ 개발자와의 인터뷰**

이들은 매우 좋은 협력자가 될 수  있다. 초기 대응 보고서의 의문 사항이나 프로세스에 대해 직접 질의함으로써 보고서에 기록되지 않거나, 의문사항에 대한 정보를 수집할 수 있다. 하지만 사건 성격에 따라 이들이 조사 대상이 될 수도 있기 때문에 조심해야 한다. 

정보 수집이 완료되면 조사자는 자신의 경험과 서비스의 성격, 나타난 피해 등을 고려하여 조사 범위를 한정 지어야 한다. 

해당 시스템에 대한 접근 경로가 나열된 후에는 시나리오에 대해 기술 난이도/발생 가능성에 따라 우선순위를 정한다. 최종적으로 우선순위가 높은 시나리오를 1차 사고 조사 범위로 결정한다. 

**나. 증거 자료 수집**

사고 조사 범위에 포함되는 증거자료를 수집하는 단계. 

**각 시스템의 로그를 수집할 경우에는 장비간의 시간 차이를 명확히 기록하여 추후 상세 분석할 때 타임 라인 조사가 가능하도록 해야 한다. **

- 설정 파일
- 휘발성 데이터
- 로그
- 파일

침해 사고 분석은 일반적으로 확산을 방지하기 위해 네트워크를 차단한 후 휘발성 데이터 수집, 디스크 이미징을 통해 증거 자료를 수집한다. 운영 중인 시스템에서 데이터를 수집할 경우 사고 시스템의 증거 자료가 훼손되지 않도록 주의해야 한다. 

**다. 증거 자료 분석**

수집된 증거 자료를 분석하는 단계이다. 증거 자료를 기반으로 침해 행위를 찾아내고 분석하는 과정과, 해당 행위로 인해서 초래되는 피해 규모를 파악하는 과정 2개가 있다. 

​	**1) 침해 행위 분석**

앞서 수집한 설정, 로그파일, 메모리 등을 대상으로 침해 행위를 찾아내는 일련의 과정이다. 인터뷰 및 초기 대응에서 수집한 정보는 참고용으로만 이용하고, 직접적으로 확인하는 것이 중요하다 

​		**가) 네트워크 분석**

방화벽 설정과 네트워크 구성, 포트 상태 정보 등을 바탕으로 사고가 발생한 시점 또는 발견된 시점의 현황을 파악한다. 다수의 악성 코드가 시스템에서 정상적으로 동작하는 포트를 이용하여 외부와 연결을 시도하므로 이에 유의하며 분석을 시도한다. 

​		**나) 시스템 분석**

조사 시스템이 어떤 운영체제를 기반으로 운영 중인지와 어떤 서버를 기반으로 서비스를 제공하고 있으며 관련된 서비스가 운영중인지를 파악한다. 그리고 파악된 운영체제와 서버의 종류에 따라서 최근 발표된 취약점 정보가 존재하는지 파악한다. 

​		**다) 로그 파일 분석**

운영체제 로그를 라비롯하여 운영 중인 서비스에 따라 IIS, Apatche 와 같은 웹 로그, 등 여러 로그가 수집되며 사건 발생 시점과 탐지 시점의 차이가 커지면 매우 방대한 양의 로그를 분석해야 한다. 그러므로 LogParser와 같은 도구를 이용하여 빠르게 필요한 정보를 필터링 할 수 있는 방법을 익혀야 한다. 

​		**라) 악성 코드 분석**

악성 코드가 발견되면 그 기능과 수행 내역을 확인해야 정확한 사고 분석을 할 수 있다. 악성 코드가 가지고 있는 기능을 파악하기 위해서는 역공학 도구가 필요하다. 

​	**2) 피해 규모 파악**

피해를 정확히 알기 위해서는 로그 분석과 악성 코드 분석을 통해 공격자가 어떤 행위들을 했는지 시간 순으로 정확하게 파악할 수 있어야 한다. 이를 통해서 공격자가 시스템 계정 권한 또는 관리자 권한을 획득했는지 파악할 수 있다. 



## 보고서 작성

사고 조사 단계의 마지막 단계로, 모든 과정과 분석결과를 정리하여, 정책 결정권자에게 보고한다. 육하원칙을 기본틀로 하여 시간과 증거를 바탕으로 객관적으로 기술해야 한다. 누구나 알아보기 쉽게 작성해야 한다. 

## 시스템 복구

단순히 서비스를 재가동하는 것이 아니라 추후 동일한 사건이 재발하지 않도록 조취를 취하는 것을 포함한다. 