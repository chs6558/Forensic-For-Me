---
title: "9장 디지털 증거의 무결성 유지"
metaTitle: ""
metaDescription: ""
---

디지털 데이터는 훼손되기 쉬우며, 간단한 도구를 사용하여 완벽하게 위,변조 할 수 있다. 그러므로 **디지털 데이터를 획득한 이후부터는 위/변조 되지 않았음을 입증할 수단이 필요하다.** 

데이터의 무결성을 입증하는 기술은 암호학에서 많이 연구되었다. 대표적으로 Message Authentication Code와 전자 서명이 있다. Message authentication Code는 사전에 키를 공유한 후, 데이터 전송 도중에 위/변조 되었는지를 확인하는 방법이다. 따라서 제 3자에게 데이터가 위/변조 되지 않았음을 입증하는 것은 어렵다. 

이를 극복한 것이 전자서명이다. 전자 서명 기법은 **키를 가지고 있는 자만이 해당 데이터에 종속적인 특별한 값을 생성할 수 있고 그 외의 사람은 공개된 값을 이용하여 서명 값이 맞다는 것을 확인할 수 있다.**  여기서 서명하는 사람이 가지고 있는 키를 개인키라고 하고, 공개된 값을 공개키라 말한다. 전자 서명을 이용하면, 데이터가 위/변조 되지 않았음을 객관적으로 입증할 수 있다. 

전자 서명 기법을 구성하는 요소로 해쉬 함수가 있다. 해쉬 함수는 역변화이 어려워 무결성 확인 수단으로 많이 사용하고 있다. 현재 대부분의 디지털 포렌식 도구에서 무결성을 확인하는 수단으로 해쉬 함수 기능을 제공하고 있으나 해쉬 값 자체로는 무결성을 확인할 수 없고 별도의 절차와 결합되어 사용되어야만 무결성을 유지할 수 있다. 

## 해쉬 함수

1. **개요**
   해쉬 함수는 '임의의 비트 열을 고정된 길이의 비트 열로 변환시켜주는 함수'라고 정의할 수 있다. 암호학적으로 해쉬 함수는 해쉬 함수에 충돌회피성과 일방향성 등 몇 가지 암호학적 성질을 만족하는 함수로서 암호학을 구성하는 기본 요소가 되고있다. 

2. **해쉬 함수의 정의**

   해쉬 함수는 크게 메시지만을 입력으로 갖는 **키가 없는 해쉬 함수**와 메시지와 비밀키를 입력으로 갖는 **키가 있는 해쉬 함수**로 분류하지만 **디지털 포렌식에서는 키가 없는 해쉬만을 다룬다. **

   **기본 정의** : 어떤 함수 h가 다음 두 성질을 만족할 떄 해쉬 함수라고 부른다.

   1) 압축성 : 함수 h는 임의이 길이 입력 x를 길이가 b인 출력 h(x)에 대응시킨다.

   2) 계산 용이성 : 함수 h와 입력 x가 주어졌을 때, h(x)를 계산하는 것이 용이하다. 

   위의 두가지 성질에서 더하여 암호학에서 사용하는 해쉬 함수는 다음과 같은게 세 가지 성질을 만족해야 한다. 
   (1) 역상 저항성 : h에 대한 임의의 출력 y가 주어지고 출력 y를 생성하게 된 x는 알려지지 않은 상황에서 h(x) = y를 만족시키는 임의의 역상 x를 찾는 것이 계산적으로 불가능하다.

   (2) 제 2 역상 저항성 : 입력 x가 주어졌을 때 h(x) = h(x') 을 만족시키는 x와는 다른 입력값 x'를 찾는 것이 계산적으로 불가능하다.

   (3) 충돌 저항성 : h(x) =  h(x')을 만족시키는 임의의 서로 다른 두 입력 x,x'을 찾는 것이 계산적으로 불가능하다. 


   위 정의에서 계산적으로 불가능하다는 것은 수학적 의미가 아니라 유한한 자원을 동원해서는 사실상 값 계산이 불가능하다는 의미이다. 

   암호학적으로 해쉬 함수는 무결성이 요구되는 거의 모든 경우에 사용된다. 해쉬 함수는 여러 가지 방식으로 구성할 수 있지만, 컴퓨터 프로그램으로 구현이 쉽고 고속으로 동작하는 전용 해쉬함수가 많이 사용된다. 
   예를들어 MD5는 32bit CPU에서 소프트웨어 구현에 적합하게 설계된 해쉬 함수이다. 

   디지털 포렌식 조사를 할 때, 이러한 전용 해쉬 함수를 활용하여 다음과 같은 방식으로 증거의 무결성을 검증하는데 활용되고 있다. 

   1. **데이터 m을 해쉬 함수 h에 입력하여 해쉬 값 y = h(m)을 계산한다.**
   2. **데이터 m과 해쉬 함수 y를 별도로 보관한다.**
   3. **보관되어 있는 데이터 m'이 보관 당시의 m인지 확인하기 위하여 y' = h(m')를 계산한 후 y=y'인지 확인한다.** 

   위의 방식이 무결성을 입증하는 수단으로 사용될 수 있는 이유는 **제 2 역상 저항성**때문이다. 

   여기서 주의할 점은 **해쉬 값과 데이터가 별도로 보관 되어야 하고, 둘 중 하나만 변조될 가능성이 있어야 한다는 것이다. ** 따라서 **해쉬 값이 변조되지 않았음을 쉽게 확인할 수 있도록 인쇄하여 담당자의 서명을 통한 봉인 절차가 필요하다.**

3. **해쉬 함수의 안전성**
   최근 해쉬 함수의 충돌 쌍을 효과적으로 찾을 수 있는 공격법이 개발되었다. 하지만 무결성 유지를 위해 사용하는 방법에 문제가 있으려면 제 2 역상을 발견할 수 있어야 하는데, 충돌 쌍을 발견하는 것과 제 2 역상을 발견하는 것은 근본적인 차이가 있다. 



## 전자 서명

전자 문서가 문서로서 효력을 발휘하기위해서는 작성자의 신원을 확인하거나 문서의 원본을 증명할 수 있는 방안이 필요하게 되었다. **전자 서명 기술은 전자 문서나 메시지를 보낸 사람의 신원을 확인하고 증명하기 위해 등장하였다.**

1. **전자 서명의 정의 및 원리**

   전자 서명은 **디지털 데이터가 작성된 후, 한 비트의 변화도 없어야 함을 보장해야 하며, 이러한 이유로 해당 데이터에 종속적인 값이 되어야 한다.**

   이러한 특성을 만족시키는 방법으로 공개키 암호 시스템을 이용한 전자 서명 시스템이 연구되었다. **공개키 암호화 시스템은 데이터를 암호화 할 때의 키와 복호화 할 때의 키가 다르고 암호용 키로부터 복호용 키를 알아내는 것이 계산적으로 불가능한 수학적인 체계를 이용한 것이다. **
   **전자 서명 시스템은 공개키 암호 시스템의 복호화 과정을 서명 생성 과정으로 하고, 암호화 과정을 서명 확인 과정으로 변형한 것**이다. (암호화 : 공개키, 복호화 : 개인키)

   여기서 공개키가 서명 생성자의 개인키에 대응하는 키임을 입증할 수 있어야 한다는 문제가 발생한다. 이러한 문제는 **CA**라는 기관에서 확인하여 준다. 

   전자 서명이 갖추어야 할 기본적인 성질

   - **무결성**
     서명한 데이터가 수신자에게 전송되는 과정에서 변형되지 않았음을 보장하는 성질
   - **위조 불가능성**
     특정인이 타인의 서명을 임의로 생성할 수 없는 성질
   - **부인방지**
     서명자가 자신이 서명한 사실을 부정할 수 없는 성질

## 시점확인 서비스

Time Stamping Service란 **임의의 디지털 데이터가 특정한 시점에 존재하였으며, 특정 시점 이후에는 데이터의 내용이 변경되지 않았음을 증명해주는 서비스**이다. 

디지털 데이터와 객관적인 시각 정보를 결합한 뒤 제 3자의 전자 서명을 거쳐  Time Stamping Token을 생성하는 형태로 작동한다. 

시점확인 토근은 종이 문서에 날짜가 포함된 도장으로 날인하는 것과 유사한 역할을 한다. 

시점확인 서비스는 디지털 데이터의 무결성을 집증하는 측면에서 전자 서명과 같은 기능을 제공한다고 볼 수 있다. 하지만 전자서명은 '**누가**'에 초점을 맞추었고, 시점확인은 '**언제**'에 초점을 맞추었다. 

시점 확인 서비스는 토큰을 발행하는 **시점확인 인가자 (TSA)**와 시점확인을 요청하는 **시점확인 이용자** 및 토큰의 유효성을 검증하는 **시점 확인 검증자** 3가지 유형이 있다. 

1. 서비스 이용자는 시점확인을 하고자 하는 디지털 데이터의 축약 값을 획득하여 축약 알고리즘과 함께 시점확인 인가자에게 전달한다. 
   - 이 과정에서 원본이 아닌 축약값을 전달하는 이유는 시점확인 인가자가 원본 데이터의 내용을 파악하지 못하게 함으로써 프라이버시를 보호하기 위함이다. 
   - 축약값은 일반적으로 해쉬 값을 사용한다. 
2. 서비스 인가자는 공인된 기관에서 객관적인 시각 정보를 제공받아 이용자에게서 받은 디지털 데이터에 결합하고 시점 확인 인가자로부터 생성된 시점 확인토큰임을 증명하기 위해 전자 서명을 하여 이용자에게 전달한다. 

시점 확인 토큰이 발급된 디지털 데이터의 존재성과 무결성을 입증하고자 할 때는 시점확인 토큰의 유효성만 확인하면 된다. 시점확인 검증자는 시점확인 토큰과 검증 시점의 디지털 데이터의 축약 값을 시점확인 인가자에게 전송하여 토큰의 검증을 요청한다. 이후 검증자는 검증 당시에 디지털 데이터 축약값과 검증을 요하는 디지털 데이터의 축약 값을 비교하여 원본 데이터와 동일한지 확인한다 

## 디지털 증거의 인증

무결성을 입증하는 방법으로는 해쉬 함수가 널리 사용되고 있다. 원본 데이터와 그 해쉬 값을 보관하고 있다가, 검증 시점에서 보관중인 데이터의 해쉬 값을 획득하여 보관된 해쉬 값과 일치하는지 확인함으로써 데이터의 무결성을 집증한다. 

하지만 **원본 데이터와 해쉬 값을 동시에 조작한다면 무결성을 손상시킬 수 있기 때문에 해쉬 값은 변조가 불가능한 곳에 별도로 보관해야 한다.** **또한 디지털 증거의 획득 시점이 쟁점이 될 수 있기때문에 해쉬 값과 함께 원본 데이터의 획득 시점을 명시하여야 한다.** 

해쉬 값을 출력하여 수기 서명하는 방식은 별도의 시스템 구축을 위한 비용이 발생하지 않으므로 경제적이다. 하지만 디짙러 증거의 수집 다누이가 대상 시스템의 하드 디스크에서 점차 하드 디스크 내의 사건과 관련된 파일 단위로 범위가 좁혀지고 있는 추세이다. 따라서 하드 디스크 당 하나의 해쉬 값 서명이 아니라, 하드 디스크당 다수의 해쉬 값 서명이 요구되므로 수기 서명을 하는데 어려움이 있다. 

이를 극복하기 위해 전자서명을 하는 방법도 이용할 수 있다. 